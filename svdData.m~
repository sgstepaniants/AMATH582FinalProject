% clear all; close all; clc

%% Read in Image Files
X = [];
for imageFile = dir('01/*.jpg')'
    imageFile.name
    image = im2double(imread(strcat('01/', imageFile.name)));
    
    % take red channel from image
    imageRed = image(:, :, 1);
    reshaped = reshape(imageRed, numel(imageRed), 1);
    
    % resample image
    
    X = [X reshaped];
    
    imshow(imageRed)
    hold on
    drawnow
end

%% SVD Data Matrix
[U, S, V] = svd(X, 'econ');

%% Show Results
for j = 1 : size(U, 2)
    j
    imshow(imadjust(reshape(U(:, j), 1200, 1200)));
    hold on
    drawnow
end

%% Scree Plot
imshow(imadjust(reshape(U(:, 2), 1200, 1200)))
% plot(100 * diag(S(1 : 50)) / sum(diag(S)), '*')

%% Original Video
for j = 1 : size(X, 2)
    imshow(imadjust(reshape(X(:, j), 1200, 1200)));
    hold on
    drawnow
end

%% Run FastICA
[icasig] = fastica(X)

%% Resample
image = reshape(X(:, j), 1200, 1200);
subplot(2, 1, 1), imshow(image)
title('Normal Resolution')
F = griddedInterpolant(image);
xq = (0:1.55:size(image, 1))';
yq = (0:1.55:size(image, 2))';
vq = F({xq,yq});
subplot(2, 1, 2), imshow(vq)
title('Lower Resolution')
